var e,t,n,i,o=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'];function s(e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=e,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}function r(e,t){return n=(t||document).querySelectorAll(e),Array.prototype.slice.call(n);var n}function c(e){(e.querySelector("[autofocus]")||e).focus()}function a(){r("[data-a11y-dialog]").forEach((function(e){new s(e)}))}s.prototype.create=function(){return this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=r('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach(function(e){e.addEventListener("click",this._show)}.bind(this)),this._closers=r("[data-a11y-dialog-hide]",this.$el).concat(r('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach(function(e){e.addEventListener("click",this._hide)}.bind(this)),this._fire("create"),this},s.prototype.show=function(e){return this.shown||(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,c(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",e)),this},s.prototype.hide=function(e){return this.shown?(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",e),this):this},s.prototype.destroy=function(){return this.hide(),this._openers.forEach(function(e){e.removeEventListener("click",this._show)}.bind(this)),this._closers.forEach(function(e){e.removeEventListener("click",this._hide)}.bind(this)),this._fire("destroy"),this._listeners={},this},s.prototype.on=function(e,t){return void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t),this},s.prototype.off=function(e,t){var n=(this._listeners[e]||[]).indexOf(t);return n>-1&&this._listeners[e].splice(n,1),this},s.prototype._fire=function(e,t){var n=this._listeners[e]||[],i=new CustomEvent(e,{detail:t});this.$el.dispatchEvent(i),n.forEach(function(e){e(this.$el,t)}.bind(this))},s.prototype._bindKeypress=function(e){this.$el.contains(document.activeElement)&&(this.shown&&27===e.which&&"alertdialog"!==this.$el.getAttribute("role")&&(e.preventDefault(),this.hide(e)),this.shown&&9===e.which&&function(e,t){var n=function(e){return r(o.join(","),e).filter((function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}))}(e),i=n.indexOf(document.activeElement);t.shiftKey&&0===i?(n[n.length-1].focus(),t.preventDefault()):t.shiftKey||i!==n.length-1||(n[0].focus(),t.preventDefault())}(this.$el,e))},s.prototype._maintainFocus=function(e){!this.shown||e.target.closest('[aria-modal="true"]')||e.target.closest("[data-a11y-dialog-ignore-focus-trap]")||c(this.$el)},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):window.requestAnimationFrame?window.requestAnimationFrame(a):window.setTimeout(a,16)),function(e){e.Red="Red",e.Green="Green",e.Purple="Purple"}(e||(e={})),function(e){e.Diamond="Diamond",e.Squiggle="Squiggle",e.Pill="Pill"}(t||(t={})),function(e){e.One="One",e.Two="Two",e.Three="Three"}(n||(n={})),function(e){e.Solid="Solid",e.Shaded="Shaded",e.Empty="Empty"}(i||(i={}));class l{constructor(e){this.shape=e.shape,this.fill=e.fill,this.count=e.count,this.color=e.color}attributes(){return{shape:this.shape,color:this.color,count:this.count,fill:this.fill}}static random(){let o={shape:d(t),color:d(e),count:d(n),fill:d(i)};return new l(o)}}const d=e=>{const t=Object.keys(e);return e[t[Math.floor(Math.random()*t.length)]]};class u{constructor(o=81){this.cards=[],Object.keys(e).forEach((s=>{Object.keys(t).forEach((r=>{Object.keys(n).forEach((c=>{Object.keys(i).forEach((a=>{if(this.cards.length<o){let o=new l({color:e[s],shape:t[r],count:n[c],fill:i[a]});this.cards.push(o)}}))}))}))}))}cards_left(){return this.cards.length}take_one(){if(this.cards_left()>0)return this.cards.splice(Math.floor(Math.random()*this.cards.length),1)[0];throw new RangeError("This is an empty stack. Cannot take any cards from it")}take(e=3){if(e<=this.cards_left()){let t=[];if([...Array(e)].forEach((e=>{t.push(this.take_one())})),t.length>0)return t;throw new RangeError("Not enough cards left in the stack to take.")}throw new RangeError("Not enough cards left in the stack to take.")}}class h{static is_set(e){let t=new Set,n=new Set,i=new Set,o=new Set;return e.forEach((e=>{t.add(e.color),i.add(e.count),o.add(e.fill),n.add(e.shape)})),![t,i,n,o].some((e=>2==e.size))}static any_sets(e){if(e.length<3)throw RangeError("Not enough cards to check for a set");for(let t=0;e.length-2>t;t++)for(let n=t+1;e.length-1>n;n++)for(let i=n+1;e.length>i;i++)if(h.is_set([e[t],e[n],e[i]]))return!0;return!1}}const f=function(e){switch(e){case t.Squiggle:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M39.4,63.4c0,16.1,11,19.9,10.6,28.3c-0.5,8.2-21.1,12.2-33.4,3.8s-15.8-21.2-9.3-38c3.7-7.5,4.9-14,4.8-20 c0-16.1-11-19.9-10.6-27.3C1,0.1,21.6-3,33.9,6.5s15.8,21.2,9.3,38C40.4,50.6,38.5,57.4,38.4,63.4z">\n</path>\n</svg>\n';case t.Diamond:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M24 0 L48 48 L24 96 L0 48 Z">\n</path>\n</svg>\n';case t.Pill:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M25,99.5C14.2,99.5,5.5,90.8,5.5,80V20C5.5,9.2,14.2,0.5,25,0.5S44.5,9.2,44.5,20v60 C44.5,90.8,35.8,99.5,25,99.5z">\n</path>\n</svg>\n'}};function m(e){let t=document.activeElement,n=p(),i=_(),o=+t.getAttribute("position");if(37==e.keyCode){if(1!=o){let e=""+(o-1);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(38==e.keyCode){if(o>i/n){let e=""+(o-i/n);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(39==e.keyCode){if(o<S()){let e=""+(o+1);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(40==e.keyCode&&o<S()-(i/n-1)){let e=""+(o+i/n);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}const p=function(){const e=document.querySelector(".game--container");return getComputedStyle(e).getPropertyValue("grid-template-rows").split(" ").length},y=function(e,t){let n=v();n.length<e.cards_left()&&(n.forEach((function(n){let i=e.take_one();g(n,i);let o=n.getAttribute("data-cell-index");t[o]=i})),x(),w())},g=function(e,t){let n=function(e,t){let n=+t,o=document.createElement("button");o.classList.add("card"),o.classList.add("hidden"),o.classList.add(e.count),o.setAttribute("tabindex","0"),o.setAttribute("position",""+(n+1)),o.setAttribute("role","button");for(let t=0;t<E(e.count);t++)o.innerHTML+=f(e.shape);return o.querySelectorAll(".shape").forEach((t=>{t.classList.add("shape"),t.classList.add(e.shape),t.classList.add(e.color),t.classList.add(e.fill),e.fill==i.Shaded&&function(e,t){t.querySelector("path").setAttributeNS(null,"fill","url('#shaded-"+e+"')")}(e.color,t)})),o}(t,e.getAttribute("data-cell-index"));e.appendChild(n),n.classList.remove("hidden"),e.classList.remove("empty")},v=function(){return document.querySelectorAll(".cell.empty")},b=function(){return document.querySelectorAll(".card.selected")},E=function(e){switch(e){case"One":return 1;case"Two":return 2;case"Three":return 3}},w=function(){document.querySelector("[position='1']").focus()},L=function(){return document.querySelectorAll(".card")},_=function(){return L().length},S=function(){return+L()[_()-1].getAttribute("position")},k=function(){document.querySelector("#add-column").toggleAttribute("disabled")},q=function(){document.querySelectorAll(".cell").forEach((e=>{e.addEventListener("click",C)}))},A=function(){["12","13","14"].forEach((e=>{document.querySelector(`[data-cell-index='${e}']`).remove()})),document.querySelector(".game--container").classList.remove("extra-column"),k()},x=function(){document.querySelector("#cards-left").innerHTML=$.cards_left()+" "},T=function(e,t){const n=e.target.value;document.getElementById("colorStyle").append("."+t+".Solid { fill: "+n+"} ."+t+"{stroke: "+n+"}"),document.getElementById("shaded-"+t+"-path").setAttribute("style","stroke:"+n+"; stroke-width:1")},C=function(e){let t=e.target;if(t.classList.contains("shape")&&(t=t.parentElement),"path"==t.tagName&&(t=t.parentElement.parentElement),t.classList.contains("selected"))t.classList.remove("selected");else{t.classList.add("selected");let e=[];b().forEach((t=>e.push(M[t.parentElement.getAttribute("data-cell-index")]))),3==b().length&&(h.is_set(e)?(b().forEach((e=>{e.style.transform="scale(1.5)",e.style.transform="scale(0)",e.parentElement.classList.add("empty"),setTimeout((()=>e.parentElement.removeChild(e)),200)})),F+=1,document.querySelector("#sets-found").innerHTML=""+F,15==_()?setTimeout((()=>function(){var e;let t=[12,13,14].map((e=>document.querySelector("[data-cell-index='"+e+"']")));const n=t.filter((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains("empty")}));n.forEach((e=>e.parentElement.removeChild(e))),t=t.filter((e=>{var t;if(!(null===(t=e.classList)||void 0===t?void 0:t.contains("empty")))return e}));for(let n=0;n<12;n++){let i=document.querySelector("[data-cell-index='"+n+"']");if(null===(e=i.classList)||void 0===e?void 0:e.contains("empty")){let e=t.pop();i.classList.remove("empty"),i.innerHTML=e.innerHTML,i.querySelector("button.card").setAttribute("position",String(n+1)),e.parentElement.removeChild(e)}}document.querySelector(".game--container").classList.remove("extra-column"),k()}()),1e3):setTimeout((()=>y($,M)),1e3)):(b().forEach((e=>e.classList.add("shake"))),b().forEach((e=>setTimeout((()=>e.classList.remove("shake")),500))),b().forEach((e=>e.classList.remove("selected")))))}};let $,M,F;function O(e){document.querySelector(".game--container button:nth-of-type(1)").focus()}document.addEventListener("DOMContentLoaded",(e=>{M=[],$=new u,F=0,y($,M),q(),document.addEventListener("keydown",m);new s(document.getElementById("help-dialog")).on("hide",(()=>O()));new s(document.getElementById("color-dialog")).on("hide",(()=>O()));new s(document.getElementById("check-dialog")).on("hide",(()=>O()))})),document.querySelector(".game--restart").addEventListener("click",(function(){document.querySelectorAll(".card").forEach((e=>{let t=e,n=t.parentElement;n.classList.add("empty"),n.removeChild(t)})),F=0,document.querySelector("#sets-found").innerHTML=""+F,M=[],$=new u,F=0,A(),y($,M)})),document.querySelector("#check-for-sets").addEventListener("click",(function(){let e=h.any_sets(M)?"There is at least one set on the board.":"There are no sets on the board. Add some cards.";document.querySelector("#any-sets").innerHTML=e})),document.querySelector("#add-column").addEventListener("click",(function(){let e=document.querySelector(".game--container");e.classList.add("extra-column");for(let t=12;t<=14;t++){let n=document.createElement("div");n.classList.add("cell","empty"),n.setAttribute("data-cell-index",String(t)),e.appendChild(n)}setTimeout((()=>y($,M)),700),k(),q()})),document.getElementById("red-color-selector").addEventListener("input",(function(e){T(e,"Red")})),document.getElementById("green-color-selector").addEventListener("input",(function(e){T(e,"Green")})),document.getElementById("purple-color-selector").addEventListener("input",(function(e){T(e,"Purple")}));
//# sourceMappingURL=index.js.map
