var e,t,n,o,i=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'];function s(e){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=e,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}function r(e,t){return n=(t||document).querySelectorAll(e),Array.prototype.slice.call(n);var n}function c(e){(e.querySelector("[autofocus]")||e).focus()}function l(){r("[data-a11y-dialog]").forEach((function(e){new s(e)}))}s.prototype.create=function(){return this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=r('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach(function(e){e.addEventListener("click",this._show)}.bind(this)),this._closers=r("[data-a11y-dialog-hide]",this.$el).concat(r('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach(function(e){e.addEventListener("click",this._hide)}.bind(this)),this._fire("create"),this},s.prototype.show=function(e){return this.shown||(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,c(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",e)),this},s.prototype.hide=function(e){return this.shown?(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",e),this):this},s.prototype.destroy=function(){return this.hide(),this._openers.forEach(function(e){e.removeEventListener("click",this._show)}.bind(this)),this._closers.forEach(function(e){e.removeEventListener("click",this._hide)}.bind(this)),this._fire("destroy"),this._listeners={},this},s.prototype.on=function(e,t){return void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t),this},s.prototype.off=function(e,t){var n=(this._listeners[e]||[]).indexOf(t);return n>-1&&this._listeners[e].splice(n,1),this},s.prototype._fire=function(e,t){var n=this._listeners[e]||[],o=new CustomEvent(e,{detail:t});this.$el.dispatchEvent(o),n.forEach(function(e){e(this.$el,t)}.bind(this))},s.prototype._bindKeypress=function(e){this.$el.contains(document.activeElement)&&(this.shown&&27===e.which&&"alertdialog"!==this.$el.getAttribute("role")&&(e.preventDefault(),this.hide(e)),this.shown&&9===e.which&&function(e,t){var n=function(e){return r(i.join(","),e).filter((function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}))}(e),o=n.indexOf(document.activeElement);t.shiftKey&&0===o?(n[n.length-1].focus(),t.preventDefault()):t.shiftKey||o!==n.length-1||(n[0].focus(),t.preventDefault())}(this.$el,e))},s.prototype._maintainFocus=function(e){!this.shown||e.target.closest('[aria-modal="true"]')||e.target.closest("[data-a11y-dialog-ignore-focus-trap]")||c(this.$el)},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):window.requestAnimationFrame?window.requestAnimationFrame(l):window.setTimeout(l,16)),function(e){e.Red="Red",e.Green="Green",e.Purple="Purple"}(e||(e={})),function(e){e.Diamond="Diamond",e.Squiggle="Squiggle",e.Pill="Pill"}(t||(t={})),function(e){e.One="One",e.Two="Two",e.Three="Three"}(n||(n={})),function(e){e.Solid="Solid",e.Shaded="Shaded",e.Empty="Empty"}(o||(o={}));class a{constructor(e){this.shape=e.shape,this.fill=e.fill,this.count=e.count,this.color=e.color}attributes(){return{shape:this.shape,color:this.color,count:this.count,fill:this.fill}}static random(){let i={shape:d(t),color:d(e),count:d(n),fill:d(o)};return new a(i)}}const d=e=>{const t=Object.keys(e);return e[t[Math.floor(Math.random()*t.length)]]};class u{constructor(i=81){this.cards=[],Object.keys(e).forEach((s=>{Object.keys(t).forEach((r=>{Object.keys(n).forEach((c=>{Object.keys(o).forEach((l=>{if(this.cards.length<i){let i=new a({color:e[s],shape:t[r],count:n[c],fill:o[l]});this.cards.push(i)}}))}))}))}))}cards_left(){return this.cards.length}take_one(){if(this.cards_left()>0)return this.cards.splice(Math.floor(Math.random()*this.cards.length),1)[0];throw new RangeError("This is an empty stack. Cannot take any cards from it")}take(e=3){if(e<=this.cards_left()){let t=[];if([...Array(e)].forEach((e=>{t.push(this.take_one())})),t.length>0)return t;throw new RangeError("Not enough cards left in the stack to take.")}throw new RangeError("Not enough cards left in the stack to take.")}}class h{static is_set(e){let t=new Set,n=new Set,o=new Set,i=new Set;return e.forEach((e=>{t.add(e.color),o.add(e.count),i.add(e.fill),n.add(e.shape)})),![t,o,n,i].some((e=>2==e.size))}static any_sets(e){if(e.length<3)throw RangeError("Not enough cards to check for a set");for(let t=0;e.length-2>t;t++)for(let n=t+1;e.length-1>n;n++)for(let o=n+1;e.length>o;o++)if(h.is_set([e[t],e[n],e[o]]))return!0;return!1}static hint(e,t=1){const n=function(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);for(let t=(e=[...e]).length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}(e);if(n.length<3)throw RangeError("Not enough cards to check for a set");for(let e=0;n.length-2>e;e++)for(let o=e+1;n.length-1>o;o++)for(let i=o+1;n.length>i;i++)if(h.is_set([n[e],n[o],n[i]]))return 2==t?[n[e],n[o]]:[n[e]];return[]}}const f=function(e){switch(e){case t.Squiggle:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M39.4,63.4c0,16.1,11,19.9,10.6,28.3c-0.5,8.2-21.1,12.2-33.4,3.8s-15.8-21.2-9.3-38c3.7-7.5,4.9-14,4.8-20 c0-16.1-11-19.9-10.6-27.3C1,0.1,21.6-3,33.9,6.5s15.8,21.2,9.3,38C40.4,50.6,38.5,57.4,38.4,63.4z">\n</path>\n</svg>\n';case t.Diamond:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M24 0 L48 48 L24 96 L0 48 Z">\n</path>\n</svg>\n';case t.Pill:return'\n<svg class="shape" viewBox="-2 -2 54 104">\n<path d="M25,99.5C14.2,99.5,5.5,90.8,5.5,80V20C5.5,9.2,14.2,0.5,25,0.5S44.5,9.2,44.5,20v60 C44.5,90.8,35.8,99.5,25,99.5z">\n</path>\n</svg>\n'}};function m(e){let t=document.activeElement,n=p(),o=L(),i=+t.getAttribute("position");if(37==e.keyCode){if(1!=i){let e=""+(i-1);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(38==e.keyCode){if(i>o/n){let e=""+(i-o/n);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(39==e.keyCode){if(i<q()){let e=""+(i+1);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}else if(40==e.keyCode&&i<q()-(o/n-1)){let e=""+(i+o/n);window.setTimeout((function(){document.querySelector("[position='"+e+"']").focus()}),0)}}const p=function(){const e=document.querySelector(".game--container");return getComputedStyle(e).getPropertyValue("grid-template-rows").split(" ").length},y=function(e,t){let n=g();n.length<e.cards_left()&&(n.forEach((function(n){let o=e.take_one();v(n,o);let i=n.getAttribute("data-cell-index");t[i]=o})),C(),w())},v=function(e,t){let n=function(e,t){let n=+t,i=document.createElement("button");i.classList.add("card"),i.classList.add("hidden"),i.classList.add(e.count),i.setAttribute("tabindex","0"),i.setAttribute("position",""+(n+1)),i.setAttribute("role","button");for(let t=0;t<b(e.count);t++)i.innerHTML+=f(e.shape);return i.querySelectorAll(".shape").forEach((t=>{t.classList.add("shape"),t.classList.add(e.shape),t.classList.add(e.color),t.classList.add(e.fill),e.fill==o.Shaded&&function(e,t){t.querySelector("path").setAttributeNS(null,"fill","url('#shaded-"+e+"')")}(e.color,t)})),i.card=e,i}(t,e.getAttribute("data-cell-index"));e.appendChild(n),n.classList.remove("hidden"),e.classList.remove("empty")},g=function(){return document.querySelectorAll(".cell.empty")},E=function(){return document.querySelectorAll(".card.selected")},b=function(e){switch(e){case"One":return 1;case"Two":return 2;case"Three":return 3}},w=function(){document.querySelector("[position='1']").focus()},S=function(){return document.querySelectorAll(".card")},L=function(){return S().length},q=function(){return+S()[L()-1].getAttribute("position")},_=function(){let e=document.querySelector(".game--container");e.classList.add("extra-column");for(let t=12;t<=14;t++){let n=document.createElement("div");n.classList.add("cell","empty"),n.setAttribute("data-cell-index",String(t)),e.appendChild(n)}setTimeout((()=>y(P,j)),700),A(),x()},k=function(){_(),document.querySelector("#add-column-from-dialog").remove()},A=function(){document.querySelector("#add-column").toggleAttribute("disabled")},x=function(){document.querySelectorAll(".cell").forEach((e=>{e.addEventListener("click",K)}))},$=function(e){const t=e.target.dataset.number||"1";let n=h.hint(j,parseInt(t));0===n.length&&(document.querySelector("#no-sets-no-hints").classList.add("show"),setTimeout((()=>document.querySelector("#no-sets-no-hints").classList.remove("show")),5e3)),z.hide(),document.querySelectorAll("button.card").forEach((e=>{setTimeout((()=>e.classList.remove("selected")),200)})),setTimeout((()=>{n.forEach((e=>{const t=document.querySelector(`button.card.${e.count} > svg.${e.shape}.${e.fill}.${e.color}`).parentElement;t.click(),t.focus()}))}),500)},T=function(){["12","13","14"].forEach((e=>{var t;null===(t=document.querySelector(`[data-cell-index='${e}']`))||void 0===t||t.remove()})),document.querySelector(".game--container").classList.remove("extra-column"),document.querySelector("#add-column").removeAttribute("disabled")},C=function(){document.querySelector("#cards-left").innerHTML=P.cards_left()+" "},M=function(e){const t=e.target;F(t)},F=function(e){const t=e.dataset.color,n=e.value;document.getElementById("colorStyle").append("."+t+".Solid { fill: "+n+"} ."+t+"{stroke: "+n+"}"),document.getElementById("shaded-"+t+"-path").setAttribute("style","stroke:"+n+"; stroke-width:1"),I()},O=function(e){const t=e.target.previousElementSibling;t.value=t.dataset.initialColor,F(t)},I=function(){const e=document.querySelector("#color1").value.slice(1),t=document.querySelector("#color2").value.slice(1),n=document.querySelector("#color3").value.slice(1),o=`${window.location.origin}${window.location.pathname}?c1=${e}&c2=${t}&c3=${n}`,i=document.querySelector("#permalink");i.value=o,i.parentElement.classList.add("show")},B=function(e){if(D(e)){const t=document.querySelector('[data-color="Red"]');t.value=`#${e}`,t.dataset.initialColor=`#${e}`,F(t)}},H=function(e){if(D(e)){const t=document.querySelector('[data-color="Green"]');t.value=`#${e}`,t.dataset.initialColor=`#${e}`,F(t)}},R=function(e){if(D(e)){const t=document.querySelector('[data-color="Purple"]');t.value=`#${e}`,t.dataset.initialColor=`#${e}`,F(t)}},D=function(e){return/[0-9A-Fa-f]{6}/g.test(e)},K=function(e){let t=e.target;if(t.classList.contains("shape")&&(t=t.parentElement),"path"==t.tagName&&(t=t.parentElement.parentElement),t.classList.contains("selected"))t.classList.remove("selected");else{t.classList.add("selected");let e=[];E().forEach((t=>e.push(j[t.parentElement.getAttribute("data-cell-index")]))),3==E().length&&(h.is_set(e)?(E().forEach((e=>{e.style.transform="scale(1.5)",e.style.transform="scale(0)",e.parentElement.classList.add("empty"),setTimeout((()=>e.parentElement.removeChild(e)),200)})),console.log(j),N+=1,document.querySelector("#sets-found").innerHTML=""+N,15==L()?setTimeout((()=>function(){var e;let t=[12,13,14].map((e=>document.querySelector("[data-cell-index='"+e+"']")));const n=t.filter((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains("empty")}));n.forEach((e=>e.parentElement.removeChild(e))),t=t.filter((e=>{var t;if(!(null===(t=e.classList)||void 0===t?void 0:t.contains("empty")))return e}));for(let n=0;n<12;n++){let o=document.querySelector("[data-cell-index='"+n+"']");if(null===(e=o.classList)||void 0===e?void 0:e.contains("empty")){let e=t.pop();o.classList.remove("empty"),o.innerHTML=e.innerHTML;let i=o.querySelector("button.card");j[n]=j[parseInt(e.dataset.cellIndex)],j[parseInt(e.dataset.cellIndex)]=void 0,i.setAttribute("position",String(n+1)),e.parentElement.removeChild(e)}}j=j.filter((e=>void 0!==e)),document.querySelector(".game--container").classList.remove("extra-column"),A()}()),1e3):setTimeout((()=>y(P,j)),1e3)):(E().forEach((e=>e.classList.add("shake"))),E().forEach((e=>setTimeout((()=>e.classList.remove("shake")),500))),E().forEach((e=>e.classList.remove("selected")))))}};let P,j,N,z;function G(e){document.querySelector(".game--container button:nth-of-type(1)").focus()}document.addEventListener("DOMContentLoaded",(e=>{j=[],P=new u,N=0,function(){if(window.location.search){const e=window.location.search.slice(1),t={};e.split("&").forEach((e=>{let n,o;[n,o]=e.split("="),t[n]=o})),t.c1&&B(t.c1),t.c2&&H(t.c2),t.c3&&R(t.c3)}}(),y(P,j),x(),document.addEventListener("keydown",m);new s(document.getElementById("help-dialog")).on("hide",(()=>G()));new s(document.getElementById("color-dialog")).on("hide",(()=>G())),z=new s(document.getElementById("check-dialog")),z.on("hide",(()=>V(e))),new s(document.getElementById("howto-dialog"))}));const V=function(e){var t;document.querySelector("#any-sets").innerHTML="",null===(t=document.querySelector("#add-column-from-dialog"))||void 0===t||t.removeEventListener("click",_)};document.querySelector(".game--restart").addEventListener("click",(function(){document.querySelectorAll(".card").forEach((e=>{let t=e,n=t.parentElement;n.classList.add("empty"),n.removeChild(t)})),N=0,document.querySelector("#sets-found").innerHTML=""+N,j=[],P=new u,N=0,T(),y(P,j)})),document.querySelector("#check-for-sets").addEventListener("click",(function(){var e;const t=h.any_sets(j)?"At least one set is on the board.":'There are no sets on the board. <button class="text-only" id="add-column">Add some cards.</button>';document.querySelector("#any-sets").innerHTML=t,null===(e=document.querySelector("#add-column-from-dialog"))||void 0===e||e.addEventListener("click",k)})),document.querySelector("#add-column").addEventListener("click",_),document.querySelectorAll(".color-selector").forEach((e=>e.addEventListener("input",M))),document.querySelectorAll(".reset").forEach((e=>e.addEventListener("click",O))),document.querySelector("#get-permalink").addEventListener("click",I),document.querySelector("#c2c").addEventListener("click",(function(){const e=document.querySelector("#permalink");window.navigator.clipboard?(window.navigator.clipboard.writeText(e.value),e.nextElementSibling.classList.add("success")):e.nextElementSibling.classList.add("failure"),setTimeout((()=>{e.nextElementSibling.classList.remove("failure"),e.nextElementSibling.classList.remove("success")}),5e3)})),document.querySelectorAll("#hints button").forEach((e=>e.addEventListener("click",$)));
//# sourceMappingURL=index.js.map
